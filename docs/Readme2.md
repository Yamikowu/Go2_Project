# RealSense D435 進階功能 Demo

本文件介紹今日開發的兩個 RealSense D435 進階功能，均可在 **Mac M4** 上穩定運行。

---

## 🌑 1. 夜視模式 (Night Vision)

**檔案**: `camera/demo/night_vision.py`

### 功能說明

利用 D435 的雙紅外線鏡頭 + Emitter 發射器，在 **完全黑暗** 的環境中也能清楚看見物體。

| 功能             | 說明                             |
| ---------------- | -------------------------------- |
| 雙 IR 鏡頭顯示   | 左右眼並排顯示，展示立體視覺原理 |
| Emitter 即時控制 | 開關雷射發射器、調整功率強度     |
| 夜間成像         | 無需任何可見光即可看清環境       |

### 控制鍵

- `E` — 開關 Emitter
- `+/-` — 調整功率
- `Q` — 離開

### 執行方式

```bash
sudo /Users/yamiko/Documents/VsCode/Go2_Project/.venv/bin/python \
     /Users/yamiko/Documents/VsCode/Go2_Project/camera/demo/night_vision.py
```

### 🤖 機器狗應用場景

| 場景                    | 說明                                |
| ----------------------- | ----------------------------------- |
| **夜間巡邏**      | 機器狗在關燈的房間/倉庫中自主導航   |
| **床底/櫃底探索** | 進入狹窄黑暗空間時不會撞到障礙物    |
| **安防監控**      | 無需開燈也能偵測入侵者              |
| **VSLAM 定位**    | IR 不受室內燈光顏色干擾，定位更穩定 |

---

## 📏 2. 物件體積測量器 (Object Sizer)

**檔案**: `camera/demo/object_sizer.py`

### 功能說明

使用深度相機測量物件的 **寬 × 高 × 深度**（公分），即時顯示在畫面上。

| 功能         | 說明                             |
| ------------ | -------------------------------- |
| 自動輪廓偵測 | 偵測距離範圍內的物體輪廓         |
| 3D 尺寸計算  | 利用相機內參轉換像素為實際公分   |
| 效能監控     | 整合 PerfMonitor，顯示記憶體/CPU |

### 控制鍵

- `+/-` — 調整偵測距離範圍
- `R` — 重設
- `Q` — 離開

### 執行方式

```bash
sudo /Users/yamiko/Documents/VsCode/Go2_Project/.venv/bin/python \
     /Users/yamiko/Documents/VsCode/Go2_Project/camera/demo/object_sizer.py
```

### 🤖 機器狗應用場景

| 場景                     | 說明                                             |
| ------------------------ | ------------------------------------------------ |
| **智慧避障決策**   | 根據障礙物大小決定繞道、跨越或等待               |
| **門框/通道偵測**  | 測量通道寬度，判斷機器狗能否通過                 |
| **~~抓取規劃~~** | ~~未來加裝機械爪時，根據物體尺寸規劃抓取姿態~~ |
| **安全距離調整**   | 大型障礙物需要更遠的安全距離                     |

---

## 📊 效能表現 (Mac M4)

| Demo     | 記憶體用量 | CPU 用量 |
| -------- | ---------- | -------- |
| 夜視模式 | ~80 MB     | ~15%     |
| 物件測量 | ~130 MB    | ~40%     |

兩者均可穩定運行，無 RGB 相關的 `power state` 錯誤。

---

## 🔮 未來整合方向

1. **夜視 + 避障**：在夜間模式下啟用避障功能
2. **物件測量 + 避障**：根據障礙物大小做智慧決策
3. **移植到 Jetson**：這些 Demo 的邏輯可直接複製到 Jetson 使用

---

## 相關檔案

- [SKILL.md](../.agent/skills/Go2/SKILL.md) — 開發環境指南
- [realsense_d435_features.md](../.agent/skills/Go2/resources/realsense_d435_features.md) — D435 硬體功能參考
